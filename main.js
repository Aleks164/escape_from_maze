(()=>{"use strict";function t(t){var r=Math.ceil(Math.random()*t);return r%2==0&&r++,0===r&&r++,r>=t&&(r=t-2),r}function r(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function e(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function n(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,a=[],i=!0,c=!1;try{for(e=e.call(t);!(i=(n=e.next()).done)&&(a.push(n.value),!r||a.length!==r);i=!0);}catch(t){c=!0,o=t}finally{try{i||null==e.return||e.return()}finally{if(c)throw o}}return a}}(t,r)||e(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,r,e){var o=n(r,2),a=o[0],i=o[1];return r[0]>e[0]&&t[a-1]&&(t[a-1][i]=" "),r[0]<e[0]&&t[a+1]&&(t[a+1][i]=" "),r[1]>e[1]&&t[a][i-1]&&(t[a][i-1]=" "),r[1]<e[1]&&t[a][i+1]&&(t[a][i+1]=" "),t}function a(t,r){var e=n(r,2),o=e[0],a=e[1],i=[];return t[o+2]&&" "===t[o+2][a]&&o+2!==t.length-1&&o+2!==0&&i.push([o+2,a]),t[o-2]&&" "===t[o-2][a]&&o-2!=t.length-1&&o-2!=0&&i.push([o-2,a]),t[o][a+2]&&" "===t[o][a+2]&&a+2!==t[o].length-1&&a+2!==0&&i.push([o,a+2]),t[o][a-2]&&" "===t[o][a-2]&&a-2!=t[o].length-1&&a-2!=0&&i.push([o,a-2]),i}function i(t){switch(t){case"#":return"wall";case"*":return"shortWayColor";case">":case"<":case"v":case"^":return"steps";case"horizontal":return"horizontal";case"vertical":return"vertical";default:return"empty"}}function c(t){return'<div class="mazeRow"><div class="mazeRow" style="grid-template-columns: repeat('.concat(t[0].length+1,',15px); ">\n  ').concat(Array(t[0].length).fill(0).map((function(t,r){var e="";return 0===r&&(e="<div> </div>"),"".concat(e,"<div  class=").concat(i("vertical"),">").concat(r+1,"</div>")})).join(""),"</div>\n  ").concat(t.map((function(r,e){return'<div class="mazeRow" style="grid-template-columns: repeat('.concat(t[0].length+1,',15px); ">').concat(r.split("").map((function(t,r){var n="";return 0===r&&(n="<div class=".concat(i("horizontal"),">").concat(e+1,"</div>")),"".concat(n,"<div class=").concat(i(t),">").concat(t||".","</div>")})).join(""),"</div>")})).join(""),"</div>")}function s(r){var e=document.getElementById("heigth"),n=document.getElementById("width"),i=document.getElementById("currenSize"),s=+e.value,u=+n.value;i.innerHTML="height: ".concat(s," x width: ").concat(u);var l=function(r,e){var n=function(r){for(var e,n,i=[1,1],c=i,s=[i];s.length;){r[c[0]][c[1]]="*";var u=a(r,c);if(0!==u.length){u.length>1&&s.push(c);var l=(n=(e=u).length,e[Math.floor(Math.random()*n)]);o(r,c,l),c=l}else c=s.shift()}return r[t(r.length)][1]=">",r.map((function(t){return t.join("").replaceAll("*"," ")}))}(function(r,e){var n=2*r+1,o=2*e+1,a=Array(o).fill(""),i=t(o);return a.map((function(t,r,e){return 0===r||r===e.length-1||r%2==0?Array(n).fill("#"):Array(n).fill(" ").map((function(t,e,o){return r===i&&e===n-1?" ":e%2==0||0===e||e===o.length-1?"#":"".concat(t)}))}))}(r,e));return{newMaze:n,mazeMarkup:c(n)}}(s,u),f=l.newMaze,p=l.mazeMarkup,h=window.structuredClone(f);return r&&(r.innerHTML=p),{mazeMap:h}}function u(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function l(t,r,e,n){var o=n[t].split("");o[r]=e,n[t]=o.join("")}function f(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function p(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?f(Object(e),!0).forEach((function(r){u(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):f(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function h(t,r){var e=r.startPosition,o=r.startDirection,a=r.coordList,i=r.currentWay,c=r.listOfCrosses,s=r.prev,f=r.isEscaped,h=r.crossingsParamArray;if(f)return r;var d,v,y,g,m,b=function(t,r,e,o){var a=function(t,r,e){var n=[];return e[t+1]&&" "===e[t+1][r]&&(n.push([t+1,r]),l(t+1,r,"v",e)),e[t-1]&&" "===e[t-1][r]&&(n.push([t-1,r]),l(t-1,r,"^",e))," "===e[t][r+1]&&(n.push([t,r+1]),l(t,r+1,">",e))," "===e[t][r-1]&&(n.push([t,r-1]),l(t,r-1,"<",e)),n}(e,o,t);if(!a.length)return{nextStep:[],nextDirection:"",resultLOg:[]};var i,c,s,u,f,p=n(a[0],2),h=(i=[e,o],c=[p[0],p[1]],u=[],f=">",i[0]>c[0]&&(f="^"),i[0]<c[0]&&(f="v"),i[1]>c[1]&&(f="<"),i[1]<c[1]&&(f=">"),(s=r)===f?u.push("F"):">"===s?("<"===f&&u.push("B","F"),"^"===f&&u.push("L","F"),"v"===f&&u.push("R","F")):"<"===s?(">"===f&&u.push("B","F"),"v"===f&&u.push("L","F"),"^"===f&&u.push("R","F")):"v"===s?("^"===f&&u.push("B","F"),"<"===f&&u.push("R","F"),">"===f&&u.push("L","F")):"^"===s&&("v"===f&&u.push("B","F"),">"===f&&u.push("R","F"),"<"===f&&u.push("L","F")),{nextDirection:f,resultLOg:u});return{nextStep:a,nextDirection:h.nextDirection,resultLOg:h.resultLOg}}(t,o,e[0],e[1]),O=b.nextStep,w=b.nextDirection,j=b.resultLOg;if(e[1]===t[0].length-1||e[0]===t.length-1||0===e[0]||0===e[1])return i=i.concat(j),a.push([e[0],e[1]]),h.push(u({},e.toString(),{way:i,from:s,coord:a})),f=!0,p(p({},r),{},{coordList:a,currentWay:i,crossingsParamArray:h,isEscaped:f});if(O.length>1&&"string"!=typeof O){a.push([e[0],e[1]]);var P=O.splice(1,O.length-1);c=c.concat(P),h.push(u({},e.toString(),{way:i,from:s,coord:a})),i=[],a=[],s=e.toString()}if(i=i.concat(j),O.length)a.push([e[0],e[1]]),e=O[0],o=w;else{var E=c.shift();a=[],E&&(e=E,s=(d=o=t[E[0]][E[1]],v=e,y=[],g=v[1],m=v[0],">"===d&&(y=y.concat([m,g-1])),"<"===d&&(y=y.concat([m,g+1])),"^"===d&&(y=y.concat([m+1,g])),"v"===d&&(y=y.concat([m-1,g])),y).toString()),i=[o]}return{startPosition:e,startDirection:o,coordList:a,currentWay:i,listOfCrosses:c,crossingsParamArray:h,prev:s,isEscaped:f}}function d(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||e(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function y(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?v(Object(e),!0).forEach((function(r){u(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):v(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}var g=document.getElementById("start"),m=document.getElementById("generateNewMaze"),b=document.getElementById("maze"),O=new Worker("mazeGeneratorWW.js");O.onmessage=function(t){console.log(t)},O.postMessage("ali");var w=s(b).mazeMap;m.addEventListener("click",(function(){var t=s(b);w=t.mazeMap,g.disabled=!1})),g.addEventListener("click",(function(){g.disabled=!0,m.disabled=!0,function(t,r,e){for(var o=function(t){for(var r=["<","^",">","v"],e=[0,0],n="",o=0;o<t.length;o++)for(var a=0;a<t[o].length;a++){if(r.indexOf(t[o][a])>=0){e=[o,a],n=t[o][a];break}if(n)break}return{startPosition:e,startDirection:n}}(t),a=y(y(y({},o),{coordList:[],currentWay:[],listOfCrosses:[],crossingsParamArray:[{start:{way:[],from:null,coord:[]}}],prev:"start"}),{},{isEscaped:!1});!a.isEscaped;){a=h(t,a);var i=c(t);r&&(r.innerHTML=i)}a.isEscaped&&function(t,r,e,o){var a=function(t){for(var r=t.pop(),e=Object.keys(r)[0],n=r[e].from,o=r[e].coord,a=d(o);n;)r=t.find((function(t){return!!n&&t[n]})),e=Object.keys(r)[0],n=r[e].from,o=r[e].coord,a.unshift.apply(a,d(o));return a}(t),i=setInterval((function(){if(!a.length)return clearInterval(i),void(o.disabled=!1);var t=n(a.shift(),2),s=t[0],u=t[1],l=e[s].split("");l[u]="*",e[s]=l.join("");var f=c(e);r&&(r.innerHTML=f)}),25)}(a.crossingsParamArray,r,window.structuredClone(t),e)}(w,b,m)}))})();